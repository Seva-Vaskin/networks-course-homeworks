# Практика 11. Сетевой уровень

## Трассировка маршрута с использованием ICMP (8 баллов)
Трассировка осуществляется посредством сообщений протокола ICMP. Эхо-запрос 
(ICMP-сообщение с типом «8») отправляется одному и тому же хосту назначения с увеличением с
каждым шагом значения поля TTL (времени жизни) на единицу. Маршрутизаторы на пути
следования пакета возвращают обратно запрашивающему хосту ICMP-сообщение об истечении
времени (ICMP-сообщение с типом «11»), когда поле TTL становится равным нулю. При
достижении хоста назначения тот в ответ отправляет ICMP-сообщение с типом «0» (эхо-ответ). Из
полученных ответов можно извлечь IP-адреса всех маршрутизаторов на пути следования пакета, а
также время оборота (RTT) до каждого из узлов на маршруте.

**Не используйте готовые библиотеки для работы с ICMP**, предложите свое решение на сокетах.

### Задание А. Основное приложение (6 баллов)
Основная задача – разработать свое собственное (клиентское) приложение трассировки, которое
будет использовать протокол ICMP.
Должен быть выведен на консоль список IP-адресов всех маршрутизаторов на пути от источника к
хосту назначения. Количество сообщений, которые будут отправляться каждому маршрутизатору,
должно настраиваться параметром и по каждому из пакетов должно выводиться время RTT (по
умолчанию утилита tracert использует три пакета).

### Задание Б. Вывод имен промежуточных узлов (2 балла)
В настоящее время приложение выводит только список IP-адресов всех маршрутизаторов на пути
от источника к хосту назначения. Попробуйте использовать метод (например, gethostbyname) для
получения имени каждого промежуточного узла маршрута и выводить также на консоль это имя.
Предоставьте скриншот результатов трассировки какого-либо хоста.

#### Демонстрация работы

Вызов traceroute для сравнения

```
vsevolod@lp-0734:~/spbu/networks-course-homeworks/lab11$ sudo traceroute -I example.com 
traceroute to example.com (93.184.215.14), 30 hops max, 60 byte packets
 1  10.217.85.1 (10.217.85.1)  68.776 ms  68.776 ms  68.774 ms
 2  * * *
 3  10.68.67.1 (10.68.67.1)  72.949 ms  72.959 ms  72.955 ms
 4  138.197.249.44 (138.197.249.44)  72.951 ms  72.948 ms  72.944 ms
 5  138.197.250.157 (138.197.250.157)  72.937 ms  72.935 ms  72.934 ms
 6  ffm-b5-link.ip.twelve99.net (80.239.128.22)  174.464 ms  78.996 ms  79.018 ms
 7  ffm-bb2-link.ip.twelve99.net (62.115.136.218)  70.948 ms  70.954 ms  70.953 ms
 8  prs-bb2-link.ip.twelve99.net (62.115.122.138)  78.959 ms  78.976 ms  78.969 ms
 9  rest-bb1-link.ip.twelve99.net (62.115.122.159)  158.434 ms  158.446 ms  158.447 ms
10  * ash-b2-link.ip.twelve99.net (62.115.138.190)  160.837 ms *
11  edgio-ic-315152.ip.twelve99-cust.net (213.248.83.119)  159.498 ms  159.483 ms  170.336 ms
12  ae-66.core1.dcd.edgecastcdn.net (152.195.65.153)  160.264 ms  160.273 ms  160.265 ms
13  93.184.215.14 (93.184.215.14)  156.712 ms  155.798 ms  155.812 ms

```

Мой вызов: 

``` 
vsevolod@lp-0734:~/spbu/networks-course-homeworks/lab11$ sudo python traceroute.py example.com --max-hops 30 --timeout 1
Tracing route to example.com (93.184.215.14), 30 hops max
1       10.217.85.1     69.31 ms        68.16 ms        73.00 ms        
2               *       *       *       
3       10.68.67.1      70.65 ms        69.21 ms        69.92 ms        
4       138.197.249.44  69.37 ms        72.73 ms        71.41 ms        
5       138.197.250.157 74.09 ms        71.13 ms        68.78 ms        
6       80.239.128.22 (ffm-b5-link.ip.twelve99.net)     70.05 ms        70.77 ms        68.70 ms        
7       62.115.136.218 (ffm-bb2-link.ip.twelve99.net)   68.65 ms        68.65 ms        69.54 ms        
8       62.115.122.138 (prs-bb2-link.ip.twelve99.net)   80.38 ms        79.40 ms        79.17 ms        
9       62.115.122.159 (rest-bb1-link.ip.twelve99.net)  157.22 ms       156.44 ms       156.39 ms       
10              *       *       *       
11      213.248.83.119 (edgio-ic-315152.ip.twelve99-cust.net)   260.56 ms       204.26 ms       158.85 ms       
12      152.195.65.153 (ae-66.core1.dcd.edgecastcdn.net)        158.28 ms       168.24 ms       158.61 ms       
13              *       *       *       
14              *       *       *       
15              *       *       *       
16              *       *       *       
17      80.239.128.22 (ffm-b5-link.ip.twelve99.net)     *       634.54 ms       69.15 ms        
18      62.115.122.159 (rest-bb1-link.ip.twelve99.net)  1.11 ms 8.45 ms 79.18 ms        
19      93.184.215.14   67.26 ms        8.49 ms 77.86 ms 
```

## Дистанционно-векторная маршрутизация (8 баллов)
Реализуйте распределенный алгоритм дистанционно-векторной маршрутизации для сети,
изображенной на рисунке

<img src="images/example-network.png" width=300 />

Каждый узел знает лишь о своих соседях, однако не имеет полной информации обо всей сети.

Все каналы являются двунаправленными, стоимости каналов идентичны в обоих направлениях.
При изменении стоимости каналов (расстояний до соседних узлов) узел должен разослать новый
вектор стоимостей (пакет) всем своим соседям.

Если в результате обновления изменяется стоимость маршрута, например, от узла 0 до какого-либо 
узла сети, узел 0 информирует об этом всех своих непосредственных соседей, посылая им пакет.

В дистанционно-векторном алгоритме пакетами с информацией о маршрутах обмениваются
только соседние узлы. Таким образом, узлы 1 и 2 будут обмениваться пакетами, а узлы 1 и 3 – нет.

### Задание А (6 баллов)
Реализуйте алгоритм дистанционно-векторной маршрутизации для сети на рисунке.

### Задание Б (2 балла)
Покажите работоспособность алгоритма: искусственно измените стоимость одного или
нескольких каналов и покажите, что стоимости таблиц маршрутизации на соответствующих узлах
пересчитались. Можно использовать юнит-тесты.

#### Демонстрация работы
todo

### Задание В (опционально) (2 балла)
Представьте каждый узел в виде отдельного потока. Настройка таблиц на каждом узле
происходит независимо, обмен информацией между узлами происходит асинхронно. Например,
у каждого узла может быть своя очередь, в которую другие узлы будут записывать свои
измененные пакеты со стоимостями, а текущий узел будет забирать элементы из очереди и
обрабатывать их. Используйте примитивы синхронизации потоков.

## Использование протокола IPv6 (2 балла)
Реализуйте простое клиент-серверное приложение, реализующее эхо-запросы: клиент посылает
серверу текстовое сообщение, а в ответ сервер отправляет то же сообщение, но в верхнем
регистре. Приложение должно работать на сокетах, которые настроены на работу по протоколу
TCP с обязательным использованием протокола IPv6 на сетевом уровне.

#### Демонстрация работы
todo

## Удаленное рисование (6 баллов)
Программа удаленного рисования. На первом компьютере (клиент) пользователь может рисовать
кривые мышкой на «холсте». На втором на таком же холсте (сервер) рисунок повторяется в
реальном времени. Вы можете использовать любой протокол для реализации данного
приложения. Предоставьте скриншот работы приложения.

#### Демонстрация работы
todo
